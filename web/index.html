<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Prompt Injection Scanner</title>
  <style>
    html, body { margin: 0; padding: 0; font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji", "Segoe UI Emoji"; background: #fff; color: #000; }
    .container { max-width: 760px; margin: 0 auto; padding: 32px 16px; }
    h1 { font-weight: 700; font-size: 24px; margin-bottom: 16px; }
    p { margin: 0 0 16px 0; color: #222; }
    .card { border: 1px solid #000; padding: 16px; }
    input[type=text] { width: 100%; border: 1px solid #000; padding: 10px 12px; font-size: 14px; background: #fff; color: #000; }
    .row { display: flex; gap: 12px; align-items: center; margin-top: 12px; }
    .btn { appearance: none; background: #000; color: #fff; border: 1px solid #000; padding: 10px 16px; cursor: pointer; font-size: 14px; }
    .btn:disabled { opacity: .5; cursor: not-allowed; }
    .muted { color: #444; font-size: 12px; }
    pre { background: #fff; color: #000; border: 1px solid #000; padding: 12px; overflow: auto; font-size: 12px; }
    .grid { display: grid; grid-template-columns: 1fr; gap: 12px; margin-top: 16px; }
    label { font-size: 12px; }
  </style>
</head>
<body>
  <div class="container">
    <h1>Prompt Injection Scanner</h1>
    <div class="card">
      <label for="url">Public GitHub URL</label>
      <input id="url" type="text" placeholder="https://github.com/owner/repo" />
      <div class="grid">
        <div class="row">
          <label for="minConfidence">Min confidence</label>
          <input id="minConfidence" type="number" min="0" max="1" step="0.05" value="0" style="width:120px" />
          <label><input id="strict" type="checkbox" /> strict</label>
        </div>
        <div class="row">
          <button id="scanBtn" class="btn">Scan</button>
          <span id="status" class="muted"></span>
        </div>
      </div>
    </div>

    <div class="grid">
      <div>
        <h2 style="font-size:18px; margin:16px 0 8px;">Summary</h2>
        <pre id="summary"></pre>
      </div>
      <div>
        <h2 style="font-size:18px; margin:16px 0 8px;">Findings (JSON)</h2>
        <pre id="output"></pre>
      </div>
    </div>
  </div>

  <script>
    const scanBtn = document.getElementById('scanBtn');
    const urlEl = document.getElementById('url');
    const statusEl = document.getElementById('status');
    const outEl = document.getElementById('output');
    const sumEl = document.getElementById('summary');
    const minConfidenceEl = document.getElementById('minConfidence');
    const strictEl = document.getElementById('strict');

    async function scan() {
      const url = urlEl.value.trim();
      if (!url) { alert('Enter a GitHub URL'); return; }
      scanBtn.disabled = true; statusEl.textContent = 'Scanning...'; outEl.textContent = ''; sumEl.textContent='';
      try {
        const res = await fetch('/api/scan', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ url, min_confidence: Number(minConfidenceEl.value || 0), strict: strictEl.checked })
        });
        const data = await res.json();
        if (!res.ok) { outEl.textContent = JSON.stringify(data, null, 2); statusEl.textContent = 'Error'; return; }
        outEl.textContent = JSON.stringify(data, null, 2);
        const s = data.summary || {};
        sumEl.textContent = `files: ${s.scanned_files ?? 0}/${s.total_files ?? 0}\nfindings: ${s.total_findings ?? 0}\nduration: ${s.scan_duration ?? 0}`;
        statusEl.textContent = 'Done';
      } catch (e) {
        outEl.textContent = String(e);
        statusEl.textContent = 'Error';
      } finally { scanBtn.disabled = false; }
    }
    scanBtn.addEventListener('click', scan);
  </script>
</body>
</html>


